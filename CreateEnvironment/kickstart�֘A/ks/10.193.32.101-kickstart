#version=RHEL7

install
autostep
reboot
zerombr
#nfs --server=192.168.0.147 --dir=/install/iso
#url --url=http://10.193.32.96/repos/rhel/cdrom/rhel71
cdrom
# System authorization information
auth --enableshadow --passalgo=sha512

# Run the Setup Agent on first boot
firstboot --enable
ignoredisk --only-use=sda
# Keyboard layouts
keyboard --vckeymap=jp --xlayouts='jp'
# System language
lang ja_JP.UTF-8


# Network information
network --onboot yes --device ens01 --bootproto static --ip 10.193.32.101 --netmask 255.255.255.0 --noipv6 --hostname nptcli02

#repo --name="Server-HighAvailability" --baseurl=http://10.193.32.96/repos/rhel/cdrom/rhel71
#repo --name="Server-ResilientStorage" --baseurl=file:///run/install/repo/addons/ResilientStorage


# Root password
#rootpw --iscrypted $6$TVP./1LagvB3liKT$ZvYedm9e5Xp844ElVRLdftQq7L3lP1W3uYvMjO8M8KVxYKOLfGezwFfw7SH/8PguizuQC/LJ/yab6kL3vvdHG1
rootpw oshienai
selinux --disabled
# System timezone
timezone Asia/Tokyo --isUtc
# System bootloader configuration 
bootloader --append=" crashkernel=auto" --location=mbr --boot-drive=sda

# Partition clearing information
clearpart --none --initlabel 
# Disk partitioning information
part /var --fstype="xfs" --ondisk=sda --size=10240 --label=/var
part swap --fstype="swap" --ondisk=sda --size=4096
part /ext3 --fstype="ext3" --ondisk=sda --size=10240 --label=/ext3
part / --fstype="xfs" --ondisk=sda --size=35840 --label=/
part /home --fstype="xfs" --ondisk=sda --size=10240
part /boot --fstype="xfs" --ondisk=sda --size=500 --label=/boot

%packages
@core
%end

%addon com_redhat_kdump --enable --reserve-mb='auto'
%end
%post
echo "10.193.32.96    nptmgr91">> /etc/hosts
cd /etc/yum.repos.d/;curl -O http://10.193.32.96/ks/postScript/rhel71.repo
cd /etc/yum.repos.d/;curl -O http://10.193.32.96/ks/postScript/puppet.repo
yum -y update
yum install puppet -y
cd /etc/puppet;curl -o puppet.conf http://10.193.32.96/ks/postScript/puppet.conf.agent
cd /etc/puppet;curl -o auth.conf http://10.193.32.96/ks/postScript/auth.conf.agent
cd /etc/puppet;curl -o namespaceauth.conf http://10.193.32.96/ks/postScript/namespaceauth.conf.agent
cd /tmp;curl -o destory http://10.193.32.96/ks/postScript/destory
cd /tmp;chmod 755 destory

%end
